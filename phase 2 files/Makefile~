#-------digicode--------------------------------------------#

all: digicodea.vbe \
     digicodej.vbe \
     digicodem.vbe \
     digicodeo.vbe \
     digicoder.vbe \
     digicode_boom \
     digicode_boog \
     digicode_loon 
	     @echo "<-- Generated"

all_vbe: digicodea.vbe \
		 digicodej.vbe \
     	 digicodem.vbe \
     	 digicodeo.vbe \
		 digicoder.vbe 
		 	@echo "<-- Generated"

#-------Finite State Machine Synthesis-----------------#

vhd_to_fsm:
	rename .vhd .fsm *.vhd

digicodea.vbe: digicode.fsm
	@echo "    Encoding Synthesis -> digicodea.vbe"
	syf -CEV -a digicode

digicodej.vbe: digicode.fsm
	@echo "    Encoding Synthesis  -> digicodej.vbe"
	syf -CEV -j digicode

digicodem.vbe: digicode.fsm
	@echo "    Encoding Synthesis  -> digicodem.vbe"
	syf -CEV -m digicode

digicodeo.vbe: digicode.fsm
	@echo "    Encoding Synthesis  -> digicodeo.vbe"
	syf -CEV -o digicode

digicoder.vbe: digicode.fsm
	@echo "    Encoding Synthesis  -> digicoder.vbe"
	syf -CEV -r digicode

#-------BOOM    ---------------------------------------#

digicode_boom : digicodea_b.vbe digicodej_b.vbe digicodem_b.vbe \
			digicodeo_b.vbe digicoder_b.vbe
%_b.vbe : %.vbe
	@echo "	   Boolean Optimization -> $@ "
	boom -V -d 50 $* $*_b > $*_boom.out

#-------BOOG    ---------------------------------------#


digicode_boog : digicodea_b.vst digicodej_b.vst digicodem_b.vst \
			digicodeo_b.vst digicoder_b.vst
%.vst : %.vbe laxfile.lax
	@echo "	   Binding and optimizing on Gates -> $@ "
	boog $* $* -l laxfile > $*_boog.out


#-------LOON    ---------------------------------------#


digicode_loon : digicodea_b_l.vst digicodej_b_l.vst digicodem_b_l.vst \
			digicodeo_b_l.vst digicoder_b_l.vst
%_l.vst : %.vst laxfile.lax
	@echo "	Netlist Optimization -> $@ "
	loon $* $*_l -l laxfile > $*_loon.out


#-------PROOF   ---------------------------------------#



%_b_l_net.vbe : %_b_l.vst %.vbe
	@echo " Formal checking -> $@ "
	flatbeh $*_b_l $*_b_l_net > $*_flatbeh.log
	proof -d $* $*_b_l_net > $*_proof.log


#-------Clean Up---------------------------------------#

clean :
	rm -f  *.vbe *.enc *.vst *.out *.xsc *0.lax *~
	@echo "Erase all the files generated by the makefile"

